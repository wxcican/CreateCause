package com.mzth.createcause.model.user.impl;import android.text.TextUtils;import android.util.Log;import com.mzth.createcause.entity.OutPopilEntity;import com.mzth.createcause.entity.OutPopilEntity_copy;import com.mzth.createcause.model.user.IOutPuoIl;import net.sourceforge.pinyin4j.PinyinHelper;import net.sourceforge.pinyin4j.format.HanyuPinyinCaseType;import net.sourceforge.pinyin4j.format.HanyuPinyinOutputFormat;import net.sourceforge.pinyin4j.format.HanyuPinyinToneType;import net.sourceforge.pinyin4j.format.exception.BadHanyuPinyinOutputFormatCombination;import java.util.ArrayList;import java.util.Collections;import java.util.Comparator;import java.util.List;import java.util.PriorityQueue;/** * Created by Administrator on 2017/10/19 0019. */public class OutPopilModel implements IOutPuoIl {    private static IOutPuoIl mIOutPuoIl;    private List<OutPopilEntity> mOutPopilEntityNet;    private List<OutPopilEntity> mOutPopilEntityLetter;    private List<OutPopilEntity_copy> mOutPopilEntity_copys = new ArrayList<>();    private OutPopilModel() {    }    /**     * 单例获取对象     *     * @return     */    public static IOutPuoIl getIOutPuoIl() {        if (mIOutPuoIl == null) {            Log.i("-----", "单例");            mIOutPuoIl = new OutPopilModel();        }        return mIOutPuoIl;    }    @Override    public List<OutPopilEntity_copy> getPuoilList() {        initNetData();        initLetterData();        initSort();        if (mOutPopilEntityLetter != null) {            String title = "";            for (int i = 0; i < mOutPopilEntityLetter.size(); i++) {                String letter = mOutPopilEntityLetter.get(i).getUserInitial();                OutPopilEntity_copy mOutPopilEntity_copy;                if (!letter.equals(title)) {                    title = letter;                    mOutPopilEntity_copy = new OutPopilEntity_copy(OutPopilEntity_copy.TITLE);                    mOutPopilEntity_copy.setUserInitial(letter);                    mOutPopilEntity_copy.setUserName(mOutPopilEntityLetter.get(i).getUserName());                    mOutPopilEntity_copy.setUserPhoto(mOutPopilEntityLetter.get(i).getUserPhoto());                    mOutPopilEntity_copy.setUserImgPath(mOutPopilEntityLetter.get(i).getUserImgPath());                    mOutPopilEntity_copys.add(mOutPopilEntity_copy);                }                mOutPopilEntity_copy = new OutPopilEntity_copy(OutPopilEntity_copy.CONTENT);                mOutPopilEntity_copy.setUserInitial(letter);                mOutPopilEntity_copy.setUserName(mOutPopilEntityLetter.get(i).getUserName());                mOutPopilEntity_copy.setUserPhoto(mOutPopilEntityLetter.get(i).getUserPhoto());                mOutPopilEntity_copy.setUserImgPath(mOutPopilEntityLetter.get(i).getUserImgPath());                mOutPopilEntity_copys.add(mOutPopilEntity_copy);            }        }        return mOutPopilEntity_copys;    }    @Override    public List<OutPopilEntity_copy> findPuoilList(String search) {        List<OutPopilEntity_copy> mOutPopilEntity_copyFind = new ArrayList<>();        if (TextUtils.isEmpty(search)) {            return mOutPopilEntity_copys;        } else {            if (mOutPopilEntity_copys != null) {                for (int i = 0; i < mOutPopilEntity_copys.size(); i++) {                    String userName = mOutPopilEntity_copys.get(i).getUserName();                    String userPhoto = mOutPopilEntity_copys.get(i).getUserPhoto();                    if (userName.contains(search) || userPhoto.contains(search)) {                        mOutPopilEntity_copyFind.add(mOutPopilEntity_copys.get(i));                    }                }                return mOutPopilEntity_copyFind;            } else {                return mOutPopilEntity_copys;            }        }    }    //按照首字母排序    private void initSort() {        PinyinComparator mPinyinComparator = new PinyinComparator();        Collections.sort(mOutPopilEntityLetter, mPinyinComparator);    }    //转换为有英文字母的数据    private void initLetterData() {        mOutPopilEntityLetter = new ArrayList<>();        if (mOutPopilEntityNet != null) {            for (int i = 0; i < mOutPopilEntityNet.size(); i++) {                OutPopilEntity mOutPopilEntity = new OutPopilEntity();                mOutPopilEntity.setUserPhoto(mOutPopilEntityNet.get(i).getUserPhoto());                mOutPopilEntity.setUserImgPath(mOutPopilEntityNet.get(i).getUserImgPath());                mOutPopilEntity.setUserName(mOutPopilEntityNet.get(i).getUserName());                String pinYinOne = getPinYinOne(mOutPopilEntityNet.get(i).getUserName());                mOutPopilEntity.setUserInitial(pinYinOne);                mOutPopilEntityLetter.add(mOutPopilEntity);            }        }    }    /**     * 字符串转大写首字母     *     * @param str     * @return     */    private String getPinYinOne(String str) {        //首字母        String pinYinName = "";        if (!TextUtils.isEmpty(str)) {            //首汉字            String chestname = str.substring(0, 1);            if (!TextUtils.isEmpty(chestname)) {                String regex = "^[A-Za-z0-9]+$";                boolean matches = chestname.matches(regex);                if (matches) {                    //字母转化大写返回                    if (Character.isUpperCase(chestname.charAt(0))) {                        pinYinName = chestname;                    } else {                        pinYinName = chestname.toUpperCase();                    }                } else {                    //汉字                    try {                        HanyuPinyinOutputFormat mHanyuPinyinOutputFormat = new HanyuPinyinOutputFormat();                        mHanyuPinyinOutputFormat.setCaseType(HanyuPinyinCaseType.UPPERCASE);                        mHanyuPinyinOutputFormat.setToneType(HanyuPinyinToneType.WITHOUT_TONE);                        String[] stringArray = PinyinHelper.toHanyuPinyinStringArray(chestname.charAt(0), mHanyuPinyinOutputFormat);                        if (stringArray != null && stringArray.length != 0) {                            pinYinName = String.valueOf(stringArray[0].charAt(0));                        } else {                            pinYinName = "#";                        }                    } catch (BadHanyuPinyinOutputFormatCombination badHanyuPinyinOutputFormatCombination) {                        badHanyuPinyinOutputFormatCombination.printStackTrace();                    }                }            }        }        return pinYinName;    }    //初始化网络原始数据    private void initNetData() {        mOutPopilEntityNet = new ArrayList<>();        OutPopilEntity mOutPopilEntity1 = new OutPopilEntity();        mOutPopilEntity1.setUserName("去里云");        mOutPopilEntity1.setUserImgPath("salkdjf");        mOutPopilEntity1.setUserPhoto("123654321");        mOutPopilEntityNet.add(mOutPopilEntity1);        OutPopilEntity mOutPopilEntity2 = new OutPopilEntity();        mOutPopilEntity2.setUserName("我里云");        mOutPopilEntity2.setUserImgPath("salkdjf");        mOutPopilEntity2.setUserPhoto("234654321");        mOutPopilEntityNet.add(mOutPopilEntity2);        OutPopilEntity mOutPopilEntity3 = new OutPopilEntity();        mOutPopilEntity3.setUserName("饿里云");        mOutPopilEntity3.setUserImgPath("salkdjf");        mOutPopilEntity3.setUserPhoto("654654321");        mOutPopilEntityNet.add(mOutPopilEntity3);        OutPopilEntity mOutPopilEntity4 = new OutPopilEntity();        mOutPopilEntity4.setUserName("他里云");        mOutPopilEntity4.setUserImgPath("salkdjf");        mOutPopilEntity4.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity4);        OutPopilEntity mOutPopilEntity5 = new OutPopilEntity();        mOutPopilEntity5.setUserName("有里云");        mOutPopilEntity5.setUserImgPath("salkdjf");        mOutPopilEntity5.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity5);        OutPopilEntity mOutPopilEntity6 = new OutPopilEntity();        mOutPopilEntity6.setUserName("U里云");        mOutPopilEntity6.setUserImgPath("salkdjf");        mOutPopilEntity6.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity6);        OutPopilEntity mOutPopilEntity7 = new OutPopilEntity();        mOutPopilEntity7.setUserName("哦里云");        mOutPopilEntity7.setUserImgPath("salkdjf");        mOutPopilEntity7.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity7);        OutPopilEntity mOutPopilEntity8 = new OutPopilEntity();        mOutPopilEntity8.setUserName("票里云");        mOutPopilEntity8.setUserImgPath("salkdjf");        mOutPopilEntity8.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity8);        OutPopilEntity mOutPopilEntity9 = new OutPopilEntity();        mOutPopilEntity9.setUserName("啊里云");        mOutPopilEntity9.setUserImgPath("salkdjf");        mOutPopilEntity9.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity9);        OutPopilEntity mOutPopilEntity10 = new OutPopilEntity();        mOutPopilEntity10.setUserName("是里云");        mOutPopilEntity10.setUserImgPath("salkdjf");        mOutPopilEntity10.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity10);        OutPopilEntity mOutPopilEntity11 = new OutPopilEntity();        mOutPopilEntity11.setUserName("的里云");        mOutPopilEntity11.setUserImgPath("salkdjf");        mOutPopilEntity11.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity11);        OutPopilEntity mOutPopilEntity12 = new OutPopilEntity();        mOutPopilEntity12.setUserName("发里云");        mOutPopilEntity12.setUserImgPath("salkdjf");        mOutPopilEntity12.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity12);        OutPopilEntity mOutPopilEntity13 = new OutPopilEntity();        mOutPopilEntity13.setUserName("个里云");        mOutPopilEntity13.setUserImgPath("salkdjf");        mOutPopilEntity13.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity13);        OutPopilEntity mOutPopilEntity14 = new OutPopilEntity();        mOutPopilEntity14.setUserName("好里云");        mOutPopilEntity14.setUserImgPath("salkdjf");        mOutPopilEntity14.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity14);        OutPopilEntity mOutPopilEntity15 = new OutPopilEntity();        mOutPopilEntity15.setUserName("就里云");        mOutPopilEntity15.setUserImgPath("salkdjf");        mOutPopilEntity15.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity15);        OutPopilEntity mOutPopilEntity16 = new OutPopilEntity();        mOutPopilEntity16.setUserName("看里云");        mOutPopilEntity16.setUserImgPath("salkdjf");        mOutPopilEntity16.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity16);        OutPopilEntity mOutPopilEntity17 = new OutPopilEntity();        mOutPopilEntity17.setUserName("了里云");        mOutPopilEntity17.setUserImgPath("salkdjf");        mOutPopilEntity17.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity17);        OutPopilEntity mOutPopilEntity18 = new OutPopilEntity();        mOutPopilEntity18.setUserName("在里云");        mOutPopilEntity18.setUserImgPath("salkdjf");        mOutPopilEntity18.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity18);        OutPopilEntity mOutPopilEntity19 = new OutPopilEntity();        mOutPopilEntity19.setUserName("想里云");        mOutPopilEntity19.setUserImgPath("salkdjf");        mOutPopilEntity19.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity19);        OutPopilEntity mOutPopilEntity20 = new OutPopilEntity();        mOutPopilEntity20.setUserName("出里云");        mOutPopilEntity20.setUserImgPath("salkdjf");        mOutPopilEntity20.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity20);        OutPopilEntity mOutPopilEntity21 = new OutPopilEntity();        mOutPopilEntity21.setUserName("v里云");        mOutPopilEntity21.setUserImgPath("salkdjf");        mOutPopilEntity21.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity21);        OutPopilEntity mOutPopilEntity22 = new OutPopilEntity();        mOutPopilEntity22.setUserName("吧里云");        mOutPopilEntity22.setUserImgPath("salkdjf");        mOutPopilEntity22.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity22);        OutPopilEntity mOutPopilEntity23 = new OutPopilEntity();        mOutPopilEntity23.setUserName("你里云");        mOutPopilEntity23.setUserImgPath("salkdjf");        mOutPopilEntity23.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity23);        OutPopilEntity mOutPopilEntity24 = new OutPopilEntity();        mOutPopilEntity24.setUserName("吗里云");        mOutPopilEntity24.setUserImgPath("salkdjf");        mOutPopilEntity24.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity24);        OutPopilEntity mOutPopilEntity25 = new OutPopilEntity();        mOutPopilEntity25.setUserName("i里云");        mOutPopilEntity25.setUserImgPath("salkdjf");        mOutPopilEntity25.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity25);        OutPopilEntity mOutPopilEntity26 = new OutPopilEntity();        mOutPopilEntity26.setUserName("人里云");        mOutPopilEntity26.setUserImgPath("salkdjf");        mOutPopilEntity26.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity26);        OutPopilEntity mOutPopilEntity27 = new OutPopilEntity();        mOutPopilEntity27.setUserName("%里云");        mOutPopilEntity27.setUserImgPath("salkdjf");        mOutPopilEntity27.setUserPhoto("4233654321");        mOutPopilEntityNet.add(mOutPopilEntity27);    }    private class PinyinComparator implements Comparator<OutPopilEntity> {        @Override        public int compare(OutPopilEntity o1, OutPopilEntity o2) {            if (o1.getUserInitial().equals("#")) {                return 1;            } else {                return o1.getUserInitial().compareTo(o2.getUserInitial());            }        }    }}