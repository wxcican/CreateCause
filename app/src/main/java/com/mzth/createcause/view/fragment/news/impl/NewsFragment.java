package com.mzth.createcause.view.fragment.news.impl;import android.app.Dialog;import android.content.Intent;import android.support.annotation.Nullable;import android.support.design.widget.TabLayout;import android.os.Bundle;import android.support.v4.app.Fragment;import android.support.v4.app.FragmentManager;import android.support.v4.app.FragmentPagerAdapter;import android.support.v4.view.ViewPager;import android.util.Log;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.ImageView;import android.widget.LinearLayout;import android.widget.RelativeLayout;import android.widget.TextView;import com.mzth.createcause.R;import com.mzth.createcause.base.BaseFragment;import com.mzth.createcause.entity.core.CoreTypeEntity;import com.mzth.createcause.presenter.core.InfromationPresenter;import com.mzth.createcause.util.CommonUtil;import com.mzth.createcause.util.ConfigUtil;import com.mzth.createcause.view.fragment.news.INewFragment;import com.mzth.createcause.view.shareui.AllTypeActivity;import com.mzth.createcause.view.shareui.SearchActivity;import java.util.ArrayList;import java.util.List;public class NewsFragment extends BaseFragment implements INewFragment {    private TextView base_title;    private ImageView base_iv;    private TextView base_tv,base_tv_publish;    private RelativeLayout base_rl;    private LinearLayout base_ll;    private View view;    private TabLayout news_tl;    //全部分类    private LinearLayout ll_news;    //资讯内容    private ViewPager vp_news;    private Dialog dialog;    private List<Fragment> mFramgnets = new ArrayList<>();    private InfromationPresenter mInfromationPresenter;    public static int selectPosition = 0;    public static boolean idSelectPosition = false;    private List<String> titles=new ArrayList<>();    @Override    protected void initView() {        base_title = CommonUtil.getCommonUtil().bindView(view, R.id.base_title);        base_iv = CommonUtil.getCommonUtil().bindView(view, R.id.base_iv);        base_tv = CommonUtil.getCommonUtil().bindView(view, R.id.base_tv);        base_tv_publish = CommonUtil.getCommonUtil().bindView(view, R.id.base_tv_publish);        base_rl = CommonUtil.getCommonUtil().bindView(view, R.id.base_rl);        base_ll = CommonUtil.getCommonUtil().bindView(view, R.id.base_ll);        news_tl = CommonUtil.getCommonUtil().bindView(view, R.id.news_tl);        ll_news = CommonUtil.getCommonUtil().bindView(view, R.id.ll_news);        vp_news = CommonUtil.getCommonUtil().bindView(view, R.id.vp_news);    }    @Override    protected void initSet() {        //base_iv.setVisibility(View.VISIBLE);        base_iv.setVisibility(View.GONE);        base_tv.setVisibility(View.GONE);        base_tv_publish.setVisibility(View.GONE);        base_ll.setVisibility(View.GONE);        base_iv.setImageResource(R.drawable.search_icon_white);        base_title.setText("资讯");    }    @Override    protected void initAdapter() {    }    @Override    protected void initData() {        mInfromationPresenter.getTypeData();    }    @Override    protected void initListner() {        //全部分类        ll_news.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                Intent mIntent = new Intent();                mIntent.setClass(mContext, AllTypeActivity.class);                mIntent.putExtra("TYPE", "NEWS");                startActivity(mIntent);            }        });        //搜索        base_rl.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                Intent mIntent = new Intent();                mIntent.setClass(mContext, SearchActivity.class);                startActivity(mIntent);            }        });    }    @Override    protected View createView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {        view = inflater.inflate(R.layout.activity_news_fragment, container, false);        mInfromationPresenter = new InfromationPresenter();        mInfromationPresenter.initNewFragment(this);        return view;    }    @Override    public void onRequestStart() {        dialog = CommonUtil.getCommonUtil().ejectLaoding(mContext, "正在加载");    }    @Override    public void onRequestFinish() {        if (dialog != null && dialog.isShowing()) {            dialog.dismiss();        }    }    @Override    public void onRequestError() {        CommonUtil.getCommonUtil().toast(ConfigUtil.HINT_OVERTIME);    }    @Override    public void onToast(String content) {        CommonUtil.getCommonUtil().toast(content);    }    @Override    public void typeData(List<CoreTypeEntity.InfromactionTypeList> data) {        vp_news.setOffscreenPageLimit(data.size()-1);        for (int i = 0; i < data.size(); i++) {            titles.add(data.get(i).getCat_name());            mFramgnets.add(NewsContentFragment.getNewsContentFragment(data.get(i).getId()));        }        NewsFragmentContentAdapter mNewsFragmentContentAdapter = new NewsFragmentContentAdapter(getChildFragmentManager(), mFramgnets);        vp_news.setAdapter(mNewsFragmentContentAdapter);        news_tl.setupWithViewPager(vp_news);    }    /**     * ViewPage适配器     */    private class NewsFragmentContentAdapter extends FragmentPagerAdapter {        private List<Fragment> fragments;        public NewsFragmentContentAdapter(FragmentManager fm, List<Fragment> fragments) {            super(fm);            this.fragments = fragments;        }        @Override        public void destroyItem(ViewGroup container, int position, Object object) {            //  super.destroyItem(container, position, object);        }        @Override        public CharSequence getPageTitle(int position) {            return titles.get(position);        }        @Override        public Fragment getItem(int position) {            return fragments.get(position);        }        @Override        public int getCount() {            return fragments != null ? fragments.size() : 0;        }    }    @Override    public void onResume() {        super.onResume();        if (idSelectPosition) {            idSelectPosition = false;            vp_news.setCurrentItem(selectPosition);        }    }}