package com.mzth.createcause.view.fragment.user.info.impl;import android.app.Dialog;import android.support.v7.app.AppCompatActivity;import android.os.Bundle;import android.text.TextUtils;import android.util.Log;import android.view.View;import android.widget.EditText;import android.widget.ImageView;import android.widget.TextView;import com.lzy.okgo.OkGo;import com.lzy.okgo.callback.StringCallback;import com.lzy.okgo.model.Response;import com.lzy.okgo.request.base.Request;import com.mzth.createcause.R;import com.mzth.createcause.base.BaseActivity;import com.mzth.createcause.util.CommonUtil;import com.mzth.createcause.util.ConfigUtil;import org.json.JSONException;import org.json.JSONObject;/** * 绑定账号 */public class BindAccountNumberActivity extends BaseActivity {    private TextView base_title;    private ImageView base_iv;    private TextView base_tv;    private EditText et_user_info_bing_zfb_1;    private EditText et_user_info_bing_zfb_2;    private TextView btn_user_info_bing_zfb;    private Dialog dialog;    @Override    protected void setActivity() {        setContentView(R.layout.activity_bind_account_number);    }    @Override    protected void initView() {        base_title = CommonUtil.getCommonUtil().bindView(this, R.id.base_title);        base_iv = CommonUtil.getCommonUtil().bindView(this, R.id.base_iv);        base_tv = CommonUtil.getCommonUtil().bindView(this, R.id.base_tv);        et_user_info_bing_zfb_1 = CommonUtil.getCommonUtil().bindView(this, R.id.et_user_info_bing_zfb_1);        et_user_info_bing_zfb_2 = CommonUtil.getCommonUtil().bindView(this, R.id.et_user_info_bing_zfb_2);        btn_user_info_bing_zfb = CommonUtil.getCommonUtil().bindView(this, R.id.btn_user_info_bing_zfb);    }    @Override    protected void initSet() {        base_title.setText("绑定支付宝账号");        base_iv.setVisibility(View.GONE);        base_tv.setVisibility(View.GONE);    }    @Override    protected void initAdapter() {    }    @Override    protected void initData() {    }    @Override    protected void initListener() {        //提交        btn_user_info_bing_zfb.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {                String payName = et_user_info_bing_zfb_1.getText().toString().trim();                String payNum = et_user_info_bing_zfb_2.getText().toString().trim();                if (TextUtils.isEmpty(payName)) {                    CommonUtil.getCommonUtil().toast("请输入支付账户昵称");                } else if (TextUtils.isEmpty(payNum)) {                    CommonUtil.getCommonUtil().toast("请输入支付宝账号");                } else {                    OkGo.<String>post(ConfigUtil.USER_INFO_BIND_ZFB)                            .params("user_id",userId)                            .params("auth_key",userKey)                            .params("bank_name",payName)                            .params("zhifubao",payNum)                            .execute(new StringCallback() {                                @Override                                public void onStart(Request<String, ? extends Request> request) {                                    super.onStart(request);                                    dialog = CommonUtil.getCommonUtil().ejectLaoding(mContext, "正在提交");                                }                                @Override                                public void onFinish() {                                    super.onFinish();                                    if(dialog!=null&&dialog.isShowing()){                                        dialog.dismiss();                                    }                                }                                @Override                                public void onError(Response<String> response) {                                    super.onError(response);                                    CommonUtil.getCommonUtil().toast(ConfigUtil.HINT_OVERTIME);                                }                                @Override                                public void onSuccess(Response<String> response) {                                    try {                                        JSONObject mJSONObject=new JSONObject(response.body());                                        int stutus = mJSONObject.optInt("status");                                        if(stutus==1){                                            JSONObject result = mJSONObject.optJSONObject("result");                                            String zfbNum=result.optString("zhifubao");                                            CommonUtil.getCommonUtil().toast("绑定支付宝账号:  "+zfbNum+" 成功");                                            UserInfoActivity.isRefresh=true;                                            UserInfoActivity.tv3_hint="支付宝:\u2000"+zfbNum;                                            setResult(301);                                            finish();                                        }else {                                            CommonUtil.getCommonUtil().toast(mJSONObject.optString("err_msg"));                                        }                                    } catch (JSONException e) {                                        e.printStackTrace();                                    }                                }                            });                }            }        });    }}