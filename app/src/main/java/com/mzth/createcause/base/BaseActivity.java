package com.mzth.createcause.base;import android.content.Context;import android.os.Bundle;import android.support.annotation.Nullable;import android.support.v7.app.AppCompatActivity;import android.util.DisplayMetrics;import android.util.Log;import android.view.KeyEvent;import android.view.LayoutInflater;import android.view.View;import android.view.WindowManager;import android.widget.Toast;import com.mzth.createcause.R;import com.mzth.createcause.util.CommonUtil;import com.mzth.createcause.util.RetentionDataUtil;import java.util.Timer;import java.util.TimerTask;/** * Created by Activity基类 on 2017/9/26 0026. */public abstract class BaseActivity extends AppCompatActivity {    private      Boolean isExit        = false;    private      boolean isDoubleExit  = false;    public       Context mContext      = this;    public final String  TAG           = "---------";    //文章    public final String  RELEASE_ESSAY = "releaseEssay";    //视频    public final String  RELEASE_VIDEO = "releaseVideo";    //登录广播    public final String  MAIN_ACTION   = "com.mzth.createcause.view.MainActivity";    //屏幕宽    public    int    mWidthPixels;    //屏幕高    public    int    mHeightPixels;    protected String userId;    protected String userKey;    @Override    protected void onCreate(@Nullable Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        CommonUtil.getCommonUtil().addActivity(this);        setTitleBar();        //初始化UI        setActivity();        userId = RetentionDataUtil.getRetention().getString("userId", "");        userKey = RetentionDataUtil.getRetention().getString("userKey", "");        //初始化尺寸        initSize();        //初始化控件        initView();        //初始化设置        initSet();        mNoDataView = LayoutInflater.from(mContext).inflate(R.layout.item_no_data, null);        //初始化适配器        initAdapter();        //初        initListener();        //初始化数据        initData();        Log.i(TAG, "用户 ID: " + userId);        Log.i(TAG, "用户秘钥: " + userKey);    }    private void initSize() {        DisplayMetrics mDisplayMetrics = new DisplayMetrics();        getWindowManager().getDefaultDisplay().getMetrics(mDisplayMetrics);        mWidthPixels = mDisplayMetrics.widthPixels;        mHeightPixels = mDisplayMetrics.heightPixels;    }    /**     * 设置TitleBar     */    private void setTitleBar() {        getSupportActionBar().hide();        getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);    }    /**     * 设置UI     */    protected abstract void setActivity();    /**     * 初始化控件     */    protected abstract void initView();    /**     * 初始化设置     */    protected abstract void initSet();    /**     * 初始化适配器     */    protected abstract void initAdapter();    /**     * 初始化监听     */    protected abstract void initListener();    /**     * 初始化数据     */    protected abstract void initData();    //拦击返回键    @Override    public boolean onKeyDown(int keyCode, KeyEvent event) {        if (keyCode == KeyEvent.KEYCODE_BACK) {            if (isDoubleExit) {                doubleExit();            } else {                finish();            }        }        return false;    }    /**     * 双击退出     */    private void doubleExit() {        Timer mTimer = null;        if (isExit) {            finish();            System.exit(0);        } else {            isExit = true;            Toast.makeText(this, "再按一次退出应用", Toast.LENGTH_SHORT).show();            mTimer = new Timer();            mTimer.schedule(new TimerTask() {                @Override                public void run() {                    //如果2秒内没有按退出则返回原有的状态                    isExit = false;                }            }, 2000);        }    }    /**     * 是否需要双击退出     *     * @param status true 需要，false不需要     */    public void exitStatus(boolean status) {        this.isDoubleExit = status;    }    @Override    protected void onDestroy() {        super.onDestroy();        CommonUtil.getCommonUtil().delActivity(this);    }    public void back(View view) {        finish();    }    protected View mNoDataView;}