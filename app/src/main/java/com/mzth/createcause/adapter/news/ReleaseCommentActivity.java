package com.mzth.createcause.adapter.news;import android.app.Dialog;import android.content.Intent;import android.text.TextUtils;import android.util.Log;import android.view.View;import android.widget.EditText;import android.widget.ImageView;import android.widget.RelativeLayout;import android.widget.TextView;import com.lzy.okgo.OkGo;import com.lzy.okgo.callback.StringCallback;import com.lzy.okgo.model.Response;import com.lzy.okgo.request.base.Request;import com.mzth.createcause.R;import com.mzth.createcause.base.BaseActivity;import com.mzth.createcause.util.CommonUtil;import com.mzth.createcause.util.ConfigUtil;import com.mzth.createcause.util.RetentionDataUtil;import com.mzth.createcause.view.fragment.news.impl.MoreCommentActivity;import com.mzth.createcause.view.fragment.news.impl.NewsInfoActivity;import com.mzth.createcause.view.fragment.video.impl.VideoInfoActivity;import com.mzth.createcause.view.login.LoginActivity;import org.json.JSONException;import org.json.JSONObject;/** * 发表评论 */public class ReleaseCommentActivity extends BaseActivity {    private TextView base_title;    private ImageView base_iv;    private TextView base_tv;    //提交    private RelativeLayout base_rl;    private String info_id;    private EditText et_release_comment;    private Dialog dialog;    private String comment_id;    private String comment_user_id;    private String comment_user_name;    @Override    protected void setActivity() {        setContentView(R.layout.activity_release_comment);    }    @Override    protected void initView() {        base_title = CommonUtil.getCommonUtil().bindView(this, R.id.base_title);        base_iv = CommonUtil.getCommonUtil().bindView(this, R.id.base_iv);        base_tv = CommonUtil.getCommonUtil().bindView(this, R.id.base_tv);        base_rl = CommonUtil.getCommonUtil().bindView(this, R.id.base_rl);        et_release_comment = CommonUtil.getCommonUtil().bindView(this, R.id.et_release_comment);    }    @Override    protected void initSet() {        base_iv.setVisibility(View.GONE);        base_tv.setVisibility(View.VISIBLE);        base_title.setText("发表评论");        base_tv.setText("提交");    }    @Override    protected void initAdapter() {    }    @Override    protected void initData() {        Intent mIntent = getIntent();        info_id = mIntent.getStringExtra("INFO_ID");        comment_id = mIntent.getStringExtra("COMMENT_ID");        comment_user_id = mIntent.getStringExtra("COMMENT_USER_ID");        comment_user_name = mIntent.getStringExtra("COMMENT_USER_NAME");    }    @Override    protected void initListener() {        //提交        base_tv.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {                String content = et_release_comment.getText().toString().trim();                if (TextUtils.isEmpty(content)) {                    CommonUtil.getCommonUtil().toast("请输入内容进行评论");                } else {                    if (TextUtils.isEmpty(info_id)) {                        OkGo.<String>post(ConfigUtil.RELEASE_REPLY)                                .params("user_id", userId)                                .params("user_name", RetentionDataUtil.getRetention().getString("userName", ""))                                .params("comment_id", comment_id)                                .params("to_user_id", comment_user_id)                                .params("to_user_name", comment_user_name)                                .params("content", content)                                .execute(new CallBack());                    } else {                        OkGo.<String>post(ConfigUtil.RELEASE_COMMENT)                                .params("news_id", info_id)                                .params("user_id", userId)                                .params("nick_name", RetentionDataUtil.getRetention().getString("userName", ""))                                .params("content", content)                                .execute(new CallBack());                    }                }            }        });    }    private class CallBack extends StringCallback {        @Override        public void onStart(Request<String, ? extends Request> request) {            super.onStart(request);            dialog = CommonUtil.getCommonUtil().ejectLaoding(mContext, "正在提交");        }        @Override        public void onError(Response<String> response) {            super.onError(response);            CommonUtil.getCommonUtil().toast(ConfigUtil.HINT_OVERTIME);        }        @Override        public void onFinish() {            super.onFinish();            if (dialog != null && dialog.isShowing()) {                dialog.dismiss();            }        }        @Override        public void onSuccess(Response<String> response) {            try {                JSONObject jsonObject = new JSONObject(response.body());                if (jsonObject != null) {                    int status = jsonObject.optInt("status");                    if (status == 1) {                        RetentionDataUtil.getRetention().setBoolean("INFO_TAG",true);                        RetentionDataUtil.getRetention().setBoolean("MORE_TAG",true);                        CommonUtil.getCommonUtil().toast(jsonObject.optString("result"));                        finish();                    } else {                        CommonUtil.getCommonUtil().toast(jsonObject.optString("err_msg"));                    }                }            } catch (JSONException e) {                e.printStackTrace();            }        }    }}