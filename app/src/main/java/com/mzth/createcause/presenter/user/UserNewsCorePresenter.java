package com.mzth.createcause.presenter.user;import android.util.Log;import com.lzy.okgo.callback.StringCallback;import com.lzy.okgo.model.Response;import com.lzy.okgo.request.base.Request;import com.mzth.createcause.base.BasePresenter;import com.mzth.createcause.entity.user.NewsCoreEntity;import com.mzth.createcause.model.user.UserNewsModel;import com.mzth.createcause.view.fragment.user.news.INewsCoreFragment;import org.json.JSONException;import org.json.JSONObject;/** * Created by 消息中西控制器 on 2018/1/23 0023. */public class UserNewsCorePresenter extends BasePresenter {    private INewsCoreFragment mINewsCoreFragment;    /**     * 初始化UI     *     * @param iNewsCoreFragment     */    public void initUserNewsFragment(INewsCoreFragment iNewsCoreFragment) {        mINewsCoreFragment = iNewsCoreFragment;    }    /**     * 获取用户通知数据     */    public void getUserNewData(String page) {        UserNewsModel.getUserNewsNews().queryUserNewsData(user_Id, auth_key, page, new StringCallback() {            @Override            public void onError(Response<String> response) {                super.onError(response);                if (mINewsCoreFragment != null) {                    mINewsCoreFragment.onRequestError();                }            }            @Override            public void onFinish() {                super.onFinish();                if (mINewsCoreFragment != null) {                    mINewsCoreFragment.onRequestFinish();                }            }            @Override            public void onStart(Request<String, ? extends Request> request) {                super.onStart(request);                if (mINewsCoreFragment != null) {                    mINewsCoreFragment.onRequestStart();                }            }            @Override            public void onSuccess(Response<String> response) {                try {                    NewsCoreEntity mNewsCoreEntity = new NewsCoreEntity(new JSONObject(response.body()));                    if(mNewsCoreEntity.getStatus()==1){                        if (mINewsCoreFragment != null) {                            mINewsCoreFragment.initUserNewsNewsData(mNewsCoreEntity);                        }                    }else {                        if (mINewsCoreFragment != null) {                            mINewsCoreFragment.onToast(mNewsCoreEntity.getErr_msg());                        }                    }                } catch (JSONException e) {                    e.printStackTrace();                }            }        });    }    /**     * 获取刷新数据     * @param page     */    public void getRefreshUserNewData(String page) {        UserNewsModel.getUserNewsNews().queryUserNewsData(user_Id, auth_key, page, new StringCallback() {            @Override            public void onFinish() {                super.onFinish();                if (mINewsCoreFragment != null) {                    mINewsCoreFragment.onRequestFinish();                }            }            @Override            public void onSuccess(Response<String> response) {                try {                    NewsCoreEntity mNewsCoreEntity = new NewsCoreEntity(new JSONObject(response.body()));                    if(mNewsCoreEntity.getStatus()==1){                        if (mINewsCoreFragment != null) {                            mINewsCoreFragment.refreshUserNewsNewsData(mNewsCoreEntity);                        }                    }else {                        if (mINewsCoreFragment != null) {                            mINewsCoreFragment.onToast(mNewsCoreEntity.getErr_msg());                        }                    }                } catch (JSONException e) {                    e.printStackTrace();                }            }        });    }    /**     * 获取刷新数据     * @param page     */    public void getLoadUserNewData(String page) {        UserNewsModel.getUserNewsNews().queryUserNewsData(user_Id, auth_key, page, new StringCallback() {            @Override            public void onSuccess(Response<String> response) {                try {                    NewsCoreEntity mNewsCoreEntity = new NewsCoreEntity(new JSONObject(response.body()));                    if(mNewsCoreEntity.getStatus()==1){                        if (mINewsCoreFragment != null) {                            mINewsCoreFragment.loadUserNewsNewsData(mNewsCoreEntity);                        }                    }else {                        if (mINewsCoreFragment != null) {                            mINewsCoreFragment.onToast(mNewsCoreEntity.getErr_msg());                        }                    }                } catch (JSONException e) {                    e.printStackTrace();                }            }        });    }}